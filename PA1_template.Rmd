---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---



## Loading and preprocessing the data

First, we are loading the activity.csv file into a data frame.

```{r}
activity <- read.csv("activity.csv")
```


Let's take a look at the data frame's structure and how the data might look like:
```{r}
str(activity)
```


## What is mean total number of steps taken per day?

In order to calculate the mean and median values we first calculate the total 
number of steps taken each day.

```{r}
totalStepsPerDay <- aggregate(steps ~ date, data = activity, FUN = "sum")
```

The data looks something like this:
```{r}
head(totalStepsPerDay)
```

Thereafter, mean and median values can easily be derived.
```{r}
totalStepsPerDay_mean <- mean(totalStepsPerDay$steps)
totalStepsPerDay_median <- median(totalStepsPerDay$steps)
```

Mean (`r sprintf("%.0f total steps per day", totalStepsPerDay_mean)`) and median (`r sprintf("%.0f total steps per day", totalStepsPerDay_median)`) values lie rather close together.

In order to get mean and median values, the `summary()` function could also be helpful.
```{r}
summary(totalStepsPerDay)
```

The following boxplot gives a good idea about the distribution of total number of steps per day:

```{r}
boxplot(totalStepsPerDay$steps, ylab = "total number of steps per day")
```

## What is the average daily activity pattern?

In order to plot a line graph of the average number of steps taken (averaged accross all days) in each 5-minute interval, we first aggregate the activity data once more. This time, we calculate the average number of steps per interval:

```{r}
avgStepsPerInterval <- aggregate(steps ~ interval, data = activity, FUN = "mean")

# just to show the avg. number of steps across all intervals in the graph as well
avgStepsAcrossIntervals <- mean(avgStepsPerInterval$steps)
```

Next, the dataset-index with the maximum number of steps and the corresponding interval can be calculated by:
```{r}
maxIndex <- which.max(avgStepsPerInterval$steps)
avgStepsPerInterval$steps[maxIndex]
avgStepsPerInterval$interval[maxIndex]
```
Thus, we can state that the maximum number of steps is `r sprintf("%.1f", avgStepsPerInterval$steps[maxIndex])` and happens to be in interval `r avgStepsPerInterval$interval[maxIndex]`.


Finally, an according plot might be generated like this:
```{r}
library(ggplot2)

ggplot(data = avgStepsPerInterval, aes(x = interval, y = steps)) + 
    geom_line() + 
    geom_point(data = avgStepsPerInterval[maxIndex, ], 
               aes(x = interval, y = steps), col = "darkgreen") +
    geom_vline(aes(xintercept=avgStepsPerInterval$interval[maxIndex]), 
               col = "darkgreen", linetype="dashed") +
    geom_hline(aes(yintercept=avgStepsPerInterval$steps[maxIndex]), 
               col = "darkgreen", linetype="dashed") +
    annotate("text", x = 200, y = avgStepsPerInterval$steps[maxIndex], 
             label=sprintf("Max. of %.1f steps\nin interval: %.0f", 
                           avgStepsPerInterval$steps[maxIndex], 
                           avgStepsPerInterval$interval[maxIndex]), 
             family = "serif", fontface = "italic", col = "darkgreen", size = 4) +
    geom_hline(aes(yintercept=avgStepsAcrossIntervals), col = "orange") +
    annotate("text", x = 200, y = avgStepsAcrossIntervals, 
             label=sprintf("Avg. of %.1f steps\nacross all intervals", 
                           avgStepsAcrossIntervals), 
             family = "serif", fontface = "italic", col = "orange", size = 4) + 
    ggtitle("Average Daily Activity Pattern")
```


## Imputing missing values

First, let's get an idea of how many values are missing:
```{r}
totalNumberOfNAs <- sum(is.na(activity$steps))
totalNumberOfObservations <- length(activity$steps)
missingPercentage  <- totalNumberOfNAs/totalNumberOfObservations * 100
```

`r totalNumberOfNAs` out of `r totalNumberOfObservations` values in the given activity dataset are missing which is a percentage of `r sprintf("%.1f", missingPercentage)`%.

Neither `date` nor `interval` column do have `NA` values:
```{r}
sum(is.na(activity$date))
sum(is.na(activity$interval))
```


## Are there differences in activity patterns between weekdays and weekends?
